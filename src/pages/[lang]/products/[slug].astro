---
import { ui, languages } from "../../../i18n/ui";
import ProductLayout from "../../../layouts/ProductLayout.astro";

export async function getStaticPaths() {
    const paths = [];

    for (const lang of Object.keys(languages)) {
        const products = ui[lang as keyof typeof ui].productsSection.items;
        for (const product of products) {
            paths.push({
                params: { lang, slug: product.slug },
                props: { product, lang },
            });
        }
    }

    return paths;
}

const { product } = Astro.props;

// Default image if product doesn't have one
const defaultImage = "/products/shot_blasting_machine.jpeg";
const mainImage = product.image || defaultImage;

// Gallery images - these are still static for now
// To make gallery dynamic, add a gallery field to the product in CMS
const defaultGallery = [
    "/products/shot_blasting_machine.jpeg",
    "/products/pipes_shot_blasting.jpeg",
    "/products/powder_coating.jpeg",
    "/products/spray_booth.jpeg",
];
const gallery = product.gallery || defaultGallery;
---

<ProductLayout product={product} mainImage={mainImage} gallery={gallery} />
